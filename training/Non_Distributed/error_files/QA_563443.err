2021-07-13 15:09:00.919770: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
wandb: W&B syncing is set to `offline` in this directory.  Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
Traceback (most recent call last):
  File "./QA_application/training/Non_Distributed/scripts/train_first_copy.py", line 162, in <module>
    train_model(model=model_transfer, loader=data_transfer, optimizer=optimizer, criterion=criterion_transfer, scheduler=scheduler, n_epochs=60, checkpoint_path='/home/rxs1576/Saved_Models/checkpoint_224.pt') # noqa
  File "./QA_application/training/Non_Distributed/scripts/train_first_copy.py", line 121, in train_model
    loss = criterion(output, target)
  File "/home/rxs1576/.conda/envs/optho/lib/python3.7/site-packages/torch/nn/modules/module.py", line 547, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/rxs1576/.conda/envs/optho/lib/python3.7/site-packages/torch/nn/modules/loss.py", line 916, in forward
    ignore_index=self.ignore_index, reduction=self.reduction)
  File "/home/rxs1576/.conda/envs/optho/lib/python3.7/site-packages/torch/nn/functional.py", line 1995, in cross_entropy
    return nll_loss(log_softmax(input, 1), target, weight, None, ignore_index, None, reduction)
  File "/home/rxs1576/.conda/envs/optho/lib/python3.7/site-packages/torch/nn/functional.py", line 1824, in nll_loss
    ret = torch._C._nn.nll_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index)
RuntimeError: weight tensor should be defined either for all 3 classes or no classes but got weight tensor of shape: [4] at /opt/anaconda/conda-bld/pytorch-base_1571884578074/work/aten/src/THCUNN/generic/ClassNLLCriterion.cu:42
wandb: Waiting for W&B process to finish, PID 106114
wandb: Program failed with code 1. 
wandb: Find user logs for this run at: /home/rxs1576/Final_QA_FDA/wandb/offline-run-20210713_150856-d4rmjflk/logs/debug.log
wandb: Find internal logs for this run at: /home/rxs1576/Final_QA_FDA/wandb/offline-run-20210713_150856-d4rmjflk/logs/debug-internal.log
wandb: You can sync this run to the cloud by running:
wandb: wandb sync /home/rxs1576/Final_QA_FDA/wandb/offline-run-20210713_150856-d4rmjflk
